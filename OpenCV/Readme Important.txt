Please Read Following Instructions to Install OpenCV and work with it
First install Ninja-Build, CMake, CMake-GUI
Install OpenCV by following https://www.alatortsev.com/2018/09/05/installing-opencv-3-4-3-on-raspberry-pi-3-b/
Please Build OpenCV[Contrib] as well
Please also build PiCamera Support via https://www.uco.es/investiga/grupos/ava/node/40

To Enable SPI or I2C Run "sudo raspi-config", then go to "Interfacing Options" and enable them

To Configure Visual Studio, Please check
https://blogs.msdn.microsoft.com/vcblog/2018/11/26/using-visual-studio-for-cross-platform-c-development-targeting-windows-and-linux/